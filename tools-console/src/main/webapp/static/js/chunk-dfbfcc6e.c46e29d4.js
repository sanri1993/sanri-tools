(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dfbfcc6e"],{"18b3":function(e,t,n){"use strict";n("6deb")},"462e":function(e,t,n){"use strict";var a=n("b775");t["a"]={clientOpen:function(e,t,n){return a["a"].get("/tcp/client/open",{params:{host:e,port:t,reciveModel:n}})},clientClose:function(){return a["a"].get("/tcp/client/close")},clientState:function(e){return a["a"].get("/tcp/client/state",{params:{reciveModel:e}})},clientSendCommand:function(e,t){return a["a"].get("/tcp/client/sendCommand",{params:{ascii:e,hex:t}})},serverOpen:function(e,t){return a["a"].get("/tcp/server/open",{params:{port:e,reciveModel:t}})},serverClose:function(){return a["a"].get("/tcp/server/close")},serverState:function(e){return a["a"].get("/tcp/server/state",{params:{reciveModel:e}})},serverSendCommand:function(e,t){return a["a"].get("/tcp/server/sendCommand",{params:{ascii:e,hex:t}})},clients:function(){return a["a"].get("/tcp/server/clients")}}},"6deb":function(e,t,n){},b8d0:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-row",[n("el-col",{attrs:{span:24}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{inline:"",size:"small"}},[n("el-form-item",{attrs:{label:"发送模式"}},[n("el-radio-group",{attrs:{disabled:e.connectState.state},model:{value:e.sendData.sendModel,callback:function(t){e.$set(e.sendData,"sendModel",t)},expression:"sendData.sendModel"}},[n("el-radio",{attrs:{label:"ascii"}},[e._v("ascii")]),n("el-radio",{attrs:{label:"hex"}},[e._v("hex")])],1)],1),n("el-form-item",{attrs:{label:"接收模式"}},[n("el-radio-group",{attrs:{disabled:e.connectState.state},model:{value:e.connectState.reciveModel,callback:function(t){e.$set(e.connectState,"reciveModel",t)},expression:"connectState.reciveModel"}},[n("el-radio",{attrs:{label:"ascii"}},[e._v("ascii")]),n("el-radio",{attrs:{label:"hex"}},[e._v("hex")])],1)],1),n("el-form-item",[n("el-input-number",{attrs:{disabled:e.connectState.state,placeholder:"端口"},model:{value:e.connectState.port,callback:function(t){e.$set(e.connectState,"port",t)},expression:"connectState.port"}})],1),n("el-form-item",[e.connectState.state?n("el-button",{attrs:{type:"primary"},on:{click:e.close}},[e._v("关闭")]):n("el-button",{attrs:{type:"primary"},on:{click:e.listen}},[e._v("监听")])],1)],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:8}},[n("div",{staticClass:"panel panel-default"},[n("div",{staticClass:"panel-heading"},[e._v("客户端列表")]),n("div",{staticClass:"panel-body",staticStyle:{height:"400px","overflow-y":"scroll"}},[n("ul",{staticStyle:{"list-style-type":"none","line-height":"1.5"}},e._l(e.clients,(function(t){return n("li",{key:t},[n("span",{staticClass:"margin-right"},[n("el-checkbox",{model:{value:t.checked,callback:function(n){e.$set(t,"checked",n)},expression:"item.checked"}})],1),n("b",[e._v(e._s(t.host)+":"+e._s(t.port))])])})),0)])])]),n("el-col",{attrs:{span:16}},[n("div",{staticClass:"panel panel-default"},[n("div",{staticClass:"panel-heading"},[e._v("输出区")]),n("div",{staticClass:"panel-body",staticStyle:{height:"400px","overflow-y":"scroll"}},[n("ul",{staticStyle:{"line-height":"1.5"}},e._l(e.dataLines,(function(t){return n("li",{key:t},[n("span",[e._v(e._s(t.time))]),n("span",{staticClass:"margin-left"},[e._v("从 "+e._s(t.client.host)+":"+e._s(t.client.port))]),"send"===t.direction?n("b",{staticClass:"text-forestgreen margin-left"},[e._v("发送")]):e._e(),"recive"===t.direction?n("b",{staticClass:"text-danger margin-left"},[e._v("接收")]):e._e(),n("span",{staticClass:"margin-left"},[e._v(e._s(t.message))])])})),0)])])])],1)],1)},s=[],i=(n("d81d"),n("a434"),n("462e")),c=null;window.onbeforeunload=function(){null!=c&&(c.onclose=function(){},c.close())};var o={name:"Tcpserver",data:function(){return{loading:!1,connectState:{reciveModel:"ascii",port:10086,state:!1,reciveData:null},clients:[],sendData:{sendModel:"ascii",value:""},dataLines:[]}},mounted:function(){this.refreshState()},methods:{listen:function(){var e=this;this.loading=!0,i["a"].serverOpen(this.connectState.port,this.connectState.reciveModel).then((function(t){e.loading=!1,t.data.port&&(e.connectState=t.data),e.loadClients(),e.openSocket()}))},loadClients:function(){var e=this;i["a"].clients().then((function(t){e.clients=t.data.map((function(e){return e.hostAndPort}))}))},openWS:function(){},closeWS:function(){},reviceMessage:function(e){var t=e.data;if(t){var n=JSON.parse(t);switch(n.type){case"addclient":this.clients.push(n.client);break;case"delclient":for(var a=0;a<this.clients.length;a++){var s=this.clients[a];if(s.host===n.client.host&&s.port===n.client.port){this.clients.splice(a,1);break}}break;case"data":this.dataLines.push({client:n.client,time:(new Date).toLocaleTimeString(),direction:"recive",message:n.msg});break}}},openSocket:function(){if("undefined"!==typeof WebSocket){var e=this.connectState.server.host+":"+this.connectState.server.port;c=new WebSocket("ws://"+e+"/server/message"),c.onopen=this.openWS,c.onclose=this.closeWS,c.onmessage=this.reviceMessage,c.onerror=function(e){console.log(e)}}},refreshState:function(){var e=this;i["a"].serverState(this.connectState.reciveModel).then((function(t){t.data.port&&(e.connectState=t.data,t.data.state&&(e.openSocket(),e.loadClients()))}))},close:function(){var e=this;i["a"].serverClose().then((function(t){c&&c.close(),e.clients=[],e.refreshState()}))}}},l=o,r=(n("18b3"),n("2877")),d=Object(r["a"])(l,a,s,!1,null,"502ccb1e",null);t["default"]=d.exports}}]);